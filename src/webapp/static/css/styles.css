/* ==========================================================================
   ELIXIR PEPTIDE â€” ONE CSS
   Phone-sized layout, single scroll container (#app), products grid, overlays,
   cart/checkout/contact, cart FAB, toolbar, print-safety.
   ========================================================================== */

/* ---------------- Core variables ---------------- */
:root{
    --brand:#1E669E;
    --brand-600:#17517D;
    --text:#222;
    --text-strong:#111;
    --muted:#888;
    --bg:#fff;
    --bg-soft:#f9f9f9;
    --shadow-sm:0 1px 3px rgba(0,0,0,.1);
    --shadow-md:0 2px 6px rgba(0,0,0,.12);
    --radius:12px;
    --phone-width:390px;
    --fab-size:60px;
    --fab-side:16px;
    --fab-bottom:max(16px, env(safe-area-inset-bottom));
}

/* ---------------- Reset / base ---------------- */
*,
*::before,
*::after{ box-sizing:border-box; }

html, body{ height:100%; margin:0; overflow:hidden; } /* body never scrolls */
body{
    font-family:system-ui,-apple-system,"Segoe UI",Roboto,sans-serif;
    font-size:16px; line-height:1.5; color:var(--text); background:var(--bg);
}
img{ display:block; max-width:100%; }
button, input, select, textarea{ font:inherit; }
*{ user-select:auto; } input, textarea{ user-select:text; }

/* ---------------- Layout: single scroller = #app ---------------- */
#main-content{
    width:min(var(--phone-width),100vw);
    margin:0 auto;
    height:100vh;
    overflow:hidden;            /* wrapper does NOT scroll */
    padding:0;
    display:block;
}
#app{
    height:100%;
    overflow:auto;              /* the ONE scroll container */
    -webkit-overflow-scrolling:touch;
    background:var(--bg);
}

/* Header/Footer (optional) */
header{
    width:100%;
    padding:10px 16px;
    display:flex; justify-content:space-between; align-items:center;
    background:#fff;
}
.header-left{ font-weight:600; font-size:18px; }
footer{
    margin-top:auto; text-align:center; padding:1rem;
    background:var(--brand); color:#fff; font-size:.8rem;
}

/* ---------------- Overlays ---------------- */
#global-loading-screen{
    position:fixed; inset:0;
    background:rgba(255,255,255,.95); backdrop-filter:blur(4px);
    display:flex; justify-content:center; align-items:center;
    z-index:2147483647; opacity:1; transition:opacity .4s ease;
    pointer-events:all; isolation:isolate;
}
#global-loading-screen.hidden{ opacity:0; pointer-events:none; }
.spinner{
    width:60px; height:60px; border:5px solid rgba(0,0,0,.1);
    border-top-color:var(--brand); border-radius:50%;
    animation:spin .8s linear infinite;
}
@keyframes spin{ to{ transform:rotate(360deg); } }

.search-overlay{
    position:fixed; top:0; bottom:0;
    width:min(var(--phone-width),100vw); left:50%; transform:translateX(-50%);
    background:rgba(255,255,255,.98); backdrop-filter:blur(4px);
    z-index:999; opacity:0; pointer-events:none; transition:opacity .3s ease;
    display:flex; flex-direction:column; padding:1rem;
}
.search-overlay.active{ opacity:1; pointer-events:auto; }
.search-header{ position:relative; display:flex; width:100%; margin-bottom:1rem; }
.search-header input{
    flex:1; padding:.6rem 2.5rem .6rem .75rem; font-size:.95rem;
    border:1px solid #ddd; border-radius:var(--radius); outline:none;
}
.search-header input:focus{ border-color:#366199; }
#close-search{
    position:absolute; right:.5rem; top:50%; transform:translateY(-50%);
    background:transparent; border:none; font-size:1.1rem; cursor:pointer; color:var(--muted);
}
#close-search:hover{ color:#366199; }
#history-list li{
    display:flex; align-items:center; padding:.45rem .75rem;
    border-bottom:1px solid #f0f0f0; font-size:.9rem; color:var(--text);
    cursor:pointer; border-radius:8px;
}
#history-list li:hover{ background:#f5f5f5; }

/* ---------------- Products grid & cards ---------------- */
#product-list{
    margin:0; width:100%; box-sizing:border-box;
    padding:10px;                           /* symmetric gutters */
    display:grid !important;
    grid-template-columns:repeat(2, minmax(0, 1fr));
    gap:12px;
    justify-items:stretch !important;
    overflow-x:hidden;
}
.product-grid{ padding:0 !important; justify-items:stretch !important; gap:12px !important; } /* neutralize legacy */

.product-card{
    background:#fff; border-radius:var(--radius);
    display:flex; flex-direction:column; overflow:hidden;
    transition:transform .25s ease, box-shadow .25s ease;
    width:100%; max-width:none; text-decoration:none; color:inherit;
    box-shadow:0 2px 6px rgba(0,0,0,.08);
}
.product-card:hover{ transform:translateY(-2px); box-shadow:var(--shadow-md); }

.product-image{ width:100%; aspect-ratio:1/1; overflow:hidden; background:#f5f5f5; }
.product-image img{ width:100%; height:100%; object-fit:cover; }

.product-info{ padding:.5rem .75rem; flex-grow:1; display:flex; flex-direction:column; gap:.35rem; width:100%; }
.product-name{
    font-size:.95rem; font-weight:600; color:var(--text);
    display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical;
    overflow:hidden; line-height:1.2rem; min-height:2.4rem;
}
.feature-select{
    width:100%; padding:6px 8px; border-radius:6px; border:1px solid #ccc;
    font-size:.85rem; background:#fff; cursor:pointer; transition:border-color .2s, box-shadow .2s;
}
.feature-select:hover{ border-color:var(--brand); }
.feature-select:focus{ outline:none; border-color:var(--brand); box-shadow:0 0 0 2px rgba(30,102,158,.2); }

.buy-btn, .buy-counter{
    display:flex; align-items:center; justify-content:space-between;
    width:100%; height:44px; background:var(--brand); color:#fff;
    border:none; border-radius:0 0 var(--radius) var(--radius);
    font-size:1rem; font-weight:600; cursor:pointer; overflow:hidden; transition:background .3s ease;
}
.buy-btn-initial{
    display:flex; justify-content:center; align-items:center;
    width:100%; height:44px; font-size:.9rem; font-weight:600;
    background:var(--brand); color:#fff; border:none; border-radius:0 0 var(--radius) var(--radius); cursor:pointer;
}
.buy-btn button, .buy-counter button{ flex:1; height:100%; background:transparent; border:none; color:#fff; font-size:1.2rem; cursor:pointer; }
.buy-btn span, .buy-counter span{ flex:1; display:flex; justify-content:center; align-items:center; font-size:1rem; }

/* ---------------- Cart page + FAB ---------------- */
#cart-page{ display:none; padding:0 1rem 1rem 1rem; margin:0 auto; width:100%; }
.cart-item{
    display:flex; justify-content:space-between; align-items:center; gap:12px;
    padding:12px 16px; margin-bottom:12px; background:var(--bg-soft);
    border-radius:var(--radius); box-shadow:var(--shadow-sm);
}
.cart-item-name{ flex:1; font-weight:500; font-size:1rem; color:var(--text); word-break:break-word; }
.cart-item-controls{ display:flex; align-items:center; gap:8px; }
.cart-item-controls button{
    width:32px; height:32px; border:none; border-radius:6px; background:var(--brand); color:#fff; font-size:1.2rem;
}
.cart-item-controls .qty{ min-width:24px; text-align:center; font-weight:500; font-size:1rem; }
.cart-item-price{ font-weight:700; font-size:1rem; white-space:nowrap; color:var(--text-strong); margin-left:.5rem; }
#summary-label{ display:flex; justify-content:space-between; align-items:center; font-weight:600; font-size:1rem; }
#cart-total{ margin-top:16px; font-weight:600; font-size:1.2rem; text-align:right; }
#checkout-btn, #proceed-payment-btn{
    width:100%; display:inline-block; margin-top:6px; padding:12px 20px;
    border:none; border-radius:var(--radius); font-weight:600; font-size:1rem; background:var(--brand); color:#fff;
}
#checkout-btn:hover, #proceed-payment-btn:hover{ background:var(--brand-600); }
#back-to-products{ background:#ccc; color:var(--text); }
#back-to-products:hover{ background:#b3b3b3; }

/* Floating cart icon pinned to phone edge */
#cart-icon{
    position:fixed;
    bottom:calc(var(--fab-bottom) + 16px);
    right:calc(50vw - (min(var(--phone-width), 100vw) / 2) + var(--fab-side));
    width:var(--fab-size); height:var(--fab-size); border-radius:50%;
    background:var(--brand); color:#fff; font-size:1.5rem;
    display:flex; justify-content:center; align-items:center;
    box-shadow:0 2px 6px rgba(0,0,0,.2); z-index:9999; cursor:pointer;
    transition:transform .15s ease, box-shadow .15s ease;
}
#cart-icon:hover{ transform:translateY(-1px); box-shadow:0 4px 10px rgba(0,0,0,.25); }
@media (max-width:390px){ #cart-icon{ right:var(--fab-side); } }
#cart-icon .cart-count{
    position:absolute; top:-4px; right:-4px; min-width:18px; height:18px; padding:0 4px;
    border-radius:9px; background:#E02424; color:#fff; font-size:.7rem; line-height:18px; text-align:center; display:none;
}
#cart-icon .cart-count.show{ display:inline-block; }

/* ---------------- Checkout + Delivery ---------------- */
#checkout-page{ display:none; padding:1rem; margin:0 auto; width:100%; }
#checkout-summary{ margin-bottom:12px; }
#checkout-summary .cart-item{ margin-bottom:8px; }

.delivery-toggle-container{
    display:flex; justify-content:center; align-items:center;
    background:var(--bg-soft); border-radius:var(--radius); padding:8px;
    margin-bottom:12px; box-shadow:var(--shadow-sm); gap:8px;
}
.delivery-option{
    flex:1; text-align:center; padding:10px 0; border-radius:10px;
    font-weight:500; cursor:pointer; transition:all .2s ease-in-out;
    border:1px solid transparent; background:#fff;
}
.delivery-option:hover{ background:#eef6fc; }
.delivery-option.active{
    background:var(--brand); color:#fff; border-color:var(--brand);
    box-shadow:0 2px 6px rgba(30,102,158,.2); transform:scale(1.02);
}
#delivery-map-container, #cdek-map{
    width:100%; height:500px; border-radius:var(--radius); border:1px solid #ccc; overflow:hidden;
}
#delivery-map-container.loading{ opacity:.5; pointer-events:none; }

/* ---------------- Contact page ---------------- */
#contact-page{
    display:none; margin:1.5rem auto; padding:1rem; background:#fff;
    border-radius:var(--radius); animation:fadeIn .3s ease forwards; width:100%;
}
#contact-page h2{ text-align:center; color:var(--brand); font-size:1.3rem; margin-bottom:1rem; }
#contact-form{ display:flex; flex-direction:column; gap:14px; }
#contact-form input{
    padding:12px 16px; font-size:1rem; border:1px solid #ccc; border-radius:8px;
    background:#fafafa; transition:border-color .2s ease, background-color .2s ease;
}
#contact-form input:focus{ outline:none; border-color:var(--brand); background:#fff; }
#submit-contact{
    width:100%; padding:14px 20px; font-size:1rem; font-weight:600; color:#fff;
    background:var(--brand); border:none; border-radius:10px;
}
#submit-contact:hover{ background:var(--brand-600); }
#submit-contact:disabled{ opacity:.6; cursor:not-allowed; }
@keyframes fadeIn{ from{opacity:0; transform:translateY(10px);} to{opacity:1; transform:translateY(0);} }

/* ---------------- Toolbar ---------------- */
.toolbar{
    margin:10px; display:flex; gap:.5rem; width:100%; justify-content:flex-start;
}
.toolbar-btn{
    display:flex; align-items:center; gap:.25rem;
    padding:.35rem .5rem; font-size:.9rem; font-weight:500; color:#222;
    background:#f5f5f5; cursor:pointer; border-radius:10px; border:none; height:34px;
}
.toolbar-btn svg{ width:16px; height:16px; stroke:#888; }

/* ---------------- Print safety ---------------- */
@media print{
    #global-loading-screen, .search-overlay, #cart-icon{ display:none !important; }
}